<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Quake III Arena</title>
		<style>
			html,body{height:100%;padding:0;margin:0;background:#000}
			#viewport-frame{position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}
			.loading_splash_container{position:fixed;width:64px;height:64px;left:0;right:0;top:0;bottom:0;margin:auto auto;border:0}
			.lds-spinner{color:white;display:inline-block;position:relative;width:64px;height:64px;}
			.lds-spinner div{transform-origin:32px 32px;animation:lds-spinner 1.2s linear infinite;}
			.lds-spinner div:after{content:" ";display:block;position:absolute;top:3px;left:29px;width:5px;height:14px;border-radius:20%;background:white;}
			.lds-spinner div:nth-child(1){transform:rotate(0deg);animation-delay:-1.1s;}
			.lds-spinner div:nth-child(2){transform:rotate(30deg);animation-delay:-1s;}
			.lds-spinner div:nth-child(3){transform:rotate(60deg);animation-delay:-0.9s;}
			.lds-spinner div:nth-child(4){transform:rotate(90deg);animation-delay:-0.8s;}
			.lds-spinner div:nth-child(5){transform:rotate(120deg);animation-delay:-0.7s;}
			.lds-spinner div:nth-child(6){transform:rotate(150deg);animation-delay:-0.6s;}
			.lds-spinner div:nth-child(7){transform:rotate(180deg);animation-delay:-0.5s;}
			.lds-spinner div:nth-child(8){transform:rotate(210deg);animation-delay:-0.4s;}
			.lds-spinner div:nth-child(9){transform:rotate(240deg);animation-delay:-0.3s;}
			.lds-spinner div:nth-child(10){transform:rotate(270deg);animation-delay:-0.2s;}
			.lds-spinner div:nth-child(11){transform:rotate(300deg);animation-delay:-0.1s;}
			.lds-spinner div:nth-child(12){transform:rotate(330deg);animation-delay:0s;}
			.gui_download{position:absolute;right:10px;top:10px;z-index:999;width:64px;height:64px;cursor:pointer;display:none;background-repeat:no-repeat;background-image:url("data:image/png;base64,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")}
			.gui_download:hover{filter:brightness(110%)}
			@keyframes lds-spinner{0%{opacity:1;}100%{opacity:0;}}
		</style>
	</head>
	<body>
		<div class="loading_splash_container" id="loading">
			<div class="lds-spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
		</div>
		<div class="gui_download" onclick="downloadProfileData()"></div>
		<div id="viewport-frame"></div>
		<script src="Quake3Game.js"></script>
		<script>

			var CTRLS_IDLE = 0;

			function getQueryCommands()
				{
				var search = /([^&=]+)/g;
				var query  = window.location.search.substring(1);

				var args = [];

				var match;
				while (match = search.exec(query))
					{
					var val = decodeURIComponent(match[1]);
					val = val.split(" ");
					val[0] = "+" + val[0];
					args.push.apply(args, val);
					}

				return args;
				}

			function mouseChecker()
				{
				if(document.pointerLockElement==null)
					{
					goBackButtonResetIncrement();
					}
					else
					{
					goBackButtonTimerIncrement();
					}
				}

			function goBackButtonResetIncrement()
				{
				try
					{
					CTRLS_IDLE = 0;
					// SHOWS THE DOWNLOAD BUTTON
					document.getElementsByClassName("gui_download")[0].style.display = "block";
					}
					catch(err)
					{
					}
				}
			function goBackButtonTimerIncrement()
				{
				try
					{
					CTRLS_IDLE = CTRLS_IDLE + 1;
					if (CTRLS_IDLE >= 3)
						{
						// HIDES THE DOWNLOAD BUTTON
						document.getElementsByClassName("gui_download")[0].style.display = "none";
						}
					}
					catch(err)
					{
					}
				}

			function getProfileData()
				{
				var myTempProfile = parent.profileData;
				return myTempProfile;
				}

			function clearProfileData()
				{
				parent.profileData = null;
				}

			function downloadProfileData()
				{
				try
					{
					var rawReading = FS.readFile("/base/baseq3/q3config.cfg");
					var fileAsArray = new Uint8Array(rawReading);
					download_Blob(fileAsArray, "q3config.cfg", "application/octet-stream");
					}
					catch(err)
					{
					}
				}

			function download_Blob(data, fileName, mimeType)
				{
				var blob, url;
				blob = new Blob([data], {type: mimeType});
				url = window.URL.createObjectURL(blob);
				download_URL(url, fileName);
				setTimeout(function()
					{
					return window.URL.revokeObjectURL(url);
					}, 1000);
				}

			function download_URL(data, fileName)
				{
				var a;
				a = document.createElement("a");
				a.href = data;
				a.download = fileName;
				document.body.appendChild(a);
				a.style = "display: none";
				a.click();
				a.remove();
				}

			window.onload = function()
				{
				document.getElementById("loading").style.display = "none";

				function resizeViewport()
					{
					if (!ioq3.canvas){return}
					if ((document["webkitFullScreenElement"] || document["webkitFullscreenElement"] || document["mozFullScreenElement"] || document["mozFullscreenElement"] || document["fullScreenElement"] || document["fullscreenElement"])){return}
					ioq3.setCanvasSize(ioq3.viewport.offsetWidth, ioq3.viewport.offsetHeight);
					}

				ioq3.viewport = document.getElementById("viewport-frame");
				ioq3.elementPointerLock = true;
				ioq3.exitHandler = function (err)
					{
					parent.unloadContainer();
					}

				window.addEventListener("resize", resizeViewport);

				setInterval(goBackButtonTimerIncrement, 1000);
				document.addEventListener("click", mouseChecker, false);
				document.addEventListener("dblclick", mouseChecker, false);
				document.addEventListener("mousemove", mouseChecker, false);
				document.addEventListener("pointerlockchange", mouseChecker, false);
				document.addEventListener("mozpointerlockchange", mouseChecker, false);
				document.addEventListener("webkitpointerlockchange", mouseChecker, false);

				var args = ["+set", "fs_cdn", "", "+set", "sv_master1", ""];
				args.push.apply(args, getQueryCommands());
				ioq3.callMain(args);
				};
		</script>
	</body>
</html>